<p>Hello très chers étudiants,</p>

<p>Pour ce deuxième TP de GLI, nous allons étudier AngularJS. Pour la mise en place de l’environnement, la compilation, le lancement du serveur …, nous utiliserons <a href="http://maven.apache.org/">maven</a> pour la partie serveur, <a href="https://www.npmjs.org/">npm</a> et <a href="http://bower.io/">bower</a>.</p>

<!--more-->

<h3 id="etape--1-nodejs">Etape -1: NodeJS</h3>
<p>Installez nodejs</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">sudo apt-add-repository ppa:chris-lea/node.js</code></pre></div>

<p>Rechargez la liste des paquets ;</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">sudo apt-get update</code></pre></div>

<p>Installez les paquets nodejs.</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">sudo apt-get install nodejs
<span class="c">#tester si npm est présent, </span>
npm -v
<span class="c">#sinon </span>
sudo apt-get install npm</code></pre></div>

<h3 id="etape-0-installation-de-bower">Etape 0: Installation de bower</h3>
<p>Si tout va bien, npm et node sont installés. (Voir post sur l’opération portable ou l’étape -1).</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">sudo npm install -g  bower</code></pre></div>

<h3 id="etape-1-initialisation-du-projet">Etape 1: Initialisation du projet</h3>

<p>Dans le répertoire src/main/webapp de votre projet sur le covoiturage.</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">bower install angular#1.2.26</code></pre></div>

<p>Cette action télécharge angularjs et l’install dans votre projet.</p>

<p>Allez dans le répertoire app nouvellement créé.</p>

<p>Téléchargez le fichier <a href="../../../docs/posts.json">posts.json</a> suivant. 
Dans le répertoire app</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">wget http://olivier.barais.fr/docs/posts.json</code></pre></div>

<p>Toujours dans le répértoire app, créez le fichier html suivant.</p>

<div class="highlight"><pre><code class="language-html" data-lang="html"><span class="cp">&lt;!doctype html&gt;</span>
<span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">&quot;en&quot;</span> <span class="na">ng-app</span> <span class="na">id=</span><span class="s">&quot;ng-app&quot;</span><span class="nt">&gt;</span>
	<span class="nt">&lt;head&gt;</span>    
		<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;bower_components/angular/angular.min.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
		<span class="nt">&lt;script&gt;</span>
		<span class="kd">function</span> <span class="nx">PostsCtrlAjax</span><span class="p">(</span><span class="nx">$scope</span><span class="p">,</span> <span class="nx">$http</span><span class="p">)</span>
		<span class="p">{</span>

		<span class="nx">$http</span><span class="p">({</span><span class="nx">method</span><span class="o">:</span> <span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;posts.json&#39;</span><span class="p">}).</span><span class="nx">success</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
		<span class="nx">$scope</span><span class="p">.</span><span class="nx">posts</span> <span class="o">=</span> <span class="nx">data</span><span class="p">;</span>
		<span class="p">});</span>
		<span class="p">}</span>
		<span class="nt">&lt;/script&gt;</span>
		<span class="nt">&lt;style&gt;</span>
		<span class="nt">body</span><span class="p">{</span><span class="k">font-family</span><span class="o">:</span><span class="n">arial</span><span class="p">;</span> <span class="k">font-size</span><span class="o">:</span><span class="m">12px</span><span class="p">;</span><span class="k">padding</span><span class="o">:</span><span class="m">10px</span><span class="p">;}</span>
		<span class="nc">.postBody</span><span class="p">{</span> <span class="k">width</span><span class="o">:</span><span class="m">550px</span><span class="p">;</span> <span class="k">border-bottom</span><span class="o">:</span><span class="k">dashed</span> <span class="m">2px</span> <span class="m">#dedede</span><span class="p">}</span>
		<span class="nc">.postBody</span> <span class="nt">a</span><span class="p">{</span><span class="k">color</span><span class="o">:</span><span class="m">#333333</span><span class="p">;</span><span class="k">text-decoration</span><span class="o">:</span><span class="k">none</span><span class="p">}</span>
		<span class="nc">.postBody</span> <span class="nt">a</span><span class="nd">:hover</span><span class="p">{</span><span class="k">color</span><span class="o">:</span><span class="m">#006699</span><span class="p">;</span><span class="k">background-color</span><span class="o">:</span><span class="m">#dedede</span><span class="p">}</span>
		<span class="nc">.time</span><span class="p">{</span><span class="k">margin</span><span class="o">:</span><span class="m">10px</span> <span class="m">0px</span> <span class="m">10px</span> <span class="m">0px</span><span class="p">;</span> <span class="k">color</span><span class="o">:</span><span class="m">#006699</span><span class="p">;</span> <span class="p">}</span>
		<span class="nt">&lt;/style&gt;</span>
	<span class="nt">&lt;/head&gt;</span>

	<span class="nt">&lt;body</span> <span class="nt">&gt;</span>
		<span class="nt">&lt;h1&gt;</span>Parsing JSON with Angular JS Tutorial<span class="nt">&lt;/h1&gt;</span>   
			<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;ng-app&quot;</span> <span class="na">ng-app</span> <span class="na">ng-controller=</span><span class="s">&quot;PostsCtrlAjax&quot;</span><span class="nt">&gt;</span>  
			<span class="nt">&lt;div</span> <span class="na">ng-repeat=</span><span class="s">&quot;post in posts&quot;</span> <span class="na">class=</span><span class="s">&#39;postBody&#39;</span><span class="nt">&gt;</span>
			<span class="nt">&lt;h2&gt;&lt;a</span> <span class="na">href=</span><span class="s">&#39;{{post.url}}&#39;</span><span class="nt">&gt;</span>{{post.title}}<span class="nt">&lt;/a&gt;&lt;/h2&gt;</span>
			<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&#39;time&#39;</span><span class="nt">&gt;</span>{{post.time}} - {{post.author}} <span class="nt">&lt;/div&gt;</span>
			<span class="nt">&lt;p&gt;</span>{{post.description}}<span class="nt">&lt;/p&gt;</span>
			<span class="nt">&lt;img</span> <span class="na">ng-src=</span><span class="s">&quot;{{post.banner}}&quot;</span> <span class="na">style=</span><span class="s">&#39;width:550px&#39;</span><span class="nt">/&gt;</span>
			<span class="nt">&lt;/div&gt;</span>
			<span class="nt">&lt;/div&gt;</span>
	<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span></code></pre></div>

<p>Lancez un serveur web. A la racine de votre projet.</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">mvn compile tomcat7:run</code></pre></div>

<p>RDV sur <a href="http://localhost:8080/app/index.html">http://localhost:8080/app/index.html</a></p>

<h3 id="etape-2-ralisation-dune-premire-intgration">Etape 2: Réalisation d’une première intégration</h3>
<p>Modifiez l’url de téléchargement du contenu json
$http({method: ‘GET’, url: ‘posts.json’}) pour charger le json issu de vos services Java.</p>

<h3 id="etape-3-rechargement-automatique">Etape 3: Rechargement automatique</h3>
<p>Pour recharger automatiquement le contexte de votre application dès que vous modifier un fichier. Dans le pom.xml, configurez le plugin tomcat de la manière suivante.</p>

<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;plugin&gt;</span>
	<span class="nt">&lt;groupId&gt;</span>org.apache.tomcat.maven<span class="nt">&lt;/groupId&gt;</span>
	<span class="nt">&lt;artifactId&gt;</span>tomcat7-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
	<span class="nt">&lt;version&gt;</span>2.1<span class="nt">&lt;/version&gt;</span>
	<span class="nt">&lt;configuration&gt;</span>
		<span class="nt">&lt;path&gt;</span>/<span class="nt">&lt;/path&gt;</span>
		<span class="nt">&lt;contextFile&gt;</span>src/main/webapp/META-INF/context.xml<span class="nt">&lt;/contextFile&gt;</span>
	<span class="nt">&lt;/configuration&gt;</span>
<span class="nt">&lt;/plugin&gt;</span></code></pre></div>

<p>Dans le fichier src/main/webapp/META-INF/context.xml. 
Placez les lignes suivantes.</p>

<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;Context</span> <span class="na">reloadable=</span><span class="s">&quot;true&quot;</span> <span class="na">backgroundProcessorDelay=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;/Context&gt;</span></code></pre></div>

<p>Relancez</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">mvn compile tomcat7:run</code></pre></div>

<p>Dès que vous modifier une classe Java ou un fichier html, js, ou autres. Plus besoin de relancer maven.</p>

<h3 id="etape-4-partir-dun-squelette-de-projet-plus-classique">Etape 4: Partir d’un squelette de projet plus classique</h3>
<p>Repartez de ce projet de squelette d’Angular pour structurer votre application de manière classique. 
Toujours dans le répertoire web de votre application.</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">git clone https://github.com/angular/angular-seed</code></pre></div>

<h3 id="etape-5-partir-dun-squelette-de-projet-plus-classique">Etape 5: Partir d’un squelette de projet plus classique</h3>
<p>Vous pouvez utilisez eclipse ou intelliJ pour éditer votre projet.</p>

<p><a href="http://marketplace.eclipse.org/content/angularjs-eclipse#.VEdV8XVtPUY">eclipse angular</a></p>

<p><a href="https://plugins.jetbrains.com/plugin/6971?pr=phpStorm">intelliJ angular</a></p>

<h3 id="etape-6-construire-lihm-de-votre-application-de-covoiturage--laide-dangularjs">Etape 6: Construire l’IHM de votre application de covoiturage à l’aide d’angularjs.</h3>

<p>Have fun ;)</p>

